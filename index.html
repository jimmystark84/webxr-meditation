<script>
  // ... (keep universe-engine and warp-speed from previous code) ...

  // NEW COMPONENT: Procedural Space Creatures
  AFRAME.registerComponent('void-creature', {
    init: function () {
      this.time = 0;
      this.speed = Math.random() * 0.05 + 0.02;
      this.amplitude = Math.random() * 5 + 2;
      
      // Create a head and body segments
      for (let i = 0; i < 8; i++) {
        let segment = document.createElement('a-sphere');
        segment.setAttribute('radius', 0.8 - (i * 0.08)); // Tapered tail
        segment.setAttribute('position', {x: 0, y: 0, z: i * 1.5});
        segment.setAttribute('material', {
          color: '#ffffff',
          emissive: '#00f2ff',
          emissiveIntensity: 2,
          transparent: true,
          opacity: 0.6 - (i * 0.05)
        });
        segment.classList.add('creature-part');
        this.el.appendChild(segment);
      }
    },

    tick: function (t, dt) {
      this.time += dt * 0.001;
      let pos = this.el.getAttribute('position');
      
      // Swim in a wavy, serpentine path
      pos.x += Math.sin(this.time * this.speed) * 0.1;
      pos.y += Math.cos(this.time * this.speed * 0.5) * 0.05;
      pos.z += 0.05; // Slowly drift forward

      // If they go too far behind, reset them deep in the galaxy
      if (pos.z > 50) pos.z = -250;
      
      this.el.setAttribute('position', pos);

      // Undulate the body segments for a "swimming" effect
      const segments = this.el.querySelectorAll('.creature-part');
      segments.forEach((seg, i) => {
        let wave = Math.sin((this.time * 3) - (i * 0.5)) * 0.5;
        seg.setAttribute('position', {x: wave, y: wave * 0.5, z: i * 1.2});
      });
    }
  });

  // Update Universe Engine to also spawn creatures
  AFRAME.registerComponent('spawn-life', {
    init: function() {
      for(let i=0; i<10; i++) {
        let creature = document.createElement('a-entity');
        creature.setAttribute('void-creature', '');
        creature.setAttribute('position', {
          x: (Math.random()-0.5)*100, 
          y: (Math.random()-0.5)*100, 
          z: Math.random()*-200
        });
        this.el.appendChild(creature);
      }
    }
  });
</script>

<body>
  <a-scene universe-engine warp-speed spawn-life renderer="bloom: true; exposure: 1.5;">
    
    <a-assets>
      <img id="milkyway" src="milkyway.jpg" crossorigin="anonymous">
    </a-assets>

    <a-sphere id="flash" radius="0.5" material="color: white; shader: flat; opacity: 0; transparent: true" position="0 1.6 0"></a-sphere>

    <a-sky src="#milkyway" rotation="0 -90 0" animation="property: rotation; to: 0 270 0; dur: 900000; loop: true; easing: linear"></a-sky>

    <a-entity id="rig" position="0 0 0" animation="property: position; to: 0 0 -5000; dur: 500000; easing: linear">
      <a-camera look-controls fov="80"></a-camera>
      <a-entity oculus-touch-controls="hand: left"></a-entity>
      <a-entity oculus-touch-controls="hand: right"></a-entity>
    </a-entity>

    <a-light type="ambient" intensity="0.6"></a-light>
  </a-scene>
</body>

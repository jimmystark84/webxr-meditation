<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Procedural VR Meditation</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    
    <script>
      // 1. GENERATION LOGIC: Creates a unique world on every load
      AFRAME.registerComponent('procedural-world', {
        init: function () {
          const sceneEl = this.el;
          const count = 150; // Total floating objects
          const colors = ['#4CC3D9', '#EF2D5E', '#FFC65D', '#7BC8A4', '#9370DB'];

          for (let i = 0; i < count; i++) {
            let entity = document.createElement('a-octahedron');
            
            // Random Spherical Coordinates (Places objects all around you)
            let radius = 15 + Math.random() * 45;
            let theta = Math.random() * 2 * Math.PI;
            let phi = Math.acos(2 * Math.random() - 1);

            let x = radius * Math.sin(phi) * Math.cos(theta);
            let y = radius * Math.sin(phi) * Math.sin(theta);
            let z = radius * Math.cos(phi);

            entity.setAttribute('position', {x: x, y: y, z: z});
            entity.setAttribute('radius', 0.5 + Math.random() * 1.5);
            entity.setAttribute('color', colors[Math.floor(Math.random() * colors.length)]);
            
            // Random slow rotation for each crystal
            entity.setAttribute('animation', {
              property: 'rotation',
              to: `${Math.random() * 360} 360 ${Math.random() * 360}`,
              loop: true,
              dur: 15000 + Math.random() * 20000,
              easing: 'linear'
            });

            sceneEl.appendChild(entity);
          }
        }
      });

      // 2. MOVEMENT LOGIC: Gentle drift in the direction you look
      AFRAME.registerComponent('drift-move', {
        tick: function (time, timeDelta) {
          const camera = this.el.getObject3D('camera');
          if (!camera) return;

          let direction = new THREE.Vector3(0, 0, -1);
          direction.applyQuaternion(camera.quaternion);
          
          let currentPos = this.el.getAttribute('position');
          // Speed is set to 0.01 units per frame (very gentle)
          this.el.setAttribute('position', {
            x: currentPos.x + (direction.x * 0.01),
            y: currentPos.y + (direction.y * 0.01),
            z: currentPos.z + (direction.z * 0.01)